"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_command_palette_command-palette-page-element_ts"],{66611(a,b,c){c.r(b),c.d(b,{CommandPalettePageElement:()=>H});var d,e,f,g,h,i=c(76006),j=c(38772),k=c(47142),l=c(24728),m=c(79922),n=c(73072),o=c(35446),p=c(95639),q=c(34106),r=c(98950),s=c(52418),t=c(64707),u=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};let v=(d=new WeakSet,(e=class CommandPaletteItemElement extends HTMLElement{activate(a,b){this.item.activate(a,b),(0,s.j)("activate",this.item)}copy(a){return(0,s.j)("copy",this.item),this.item.copy(a)}select(){}renderOcticon(a){this.iconElement.innerHTML=a}renderAvatar(a,b){let c;c=this.item instanceof n.V?j.dy`<img src="${a}" alt="${b}" class="avatar avatar-1 avatar-small" />`:this.item instanceof o.W?j.dy`<img src="${a}" alt="${b}" class="avatar avatar-1" />`:j.dy`<img src="${a}" alt="${b}" class="avatar avatar-1 avatar-small circle" />`,(0,j.sY)(c,this.iconElement)}setItemAttributes(a){this.item=a,this.itemId=a.id,this.itemTitle=a.title,this.hint=a.hint,this.href=a.path??"",a.subtitle&&(this.subtitle=a.subtitle),a instanceof q.g&&(a.element=this)}render(a,b){if(this.renderBaseElement(),a&&(this.selected=!0),this.item instanceof l.i&&this.item.typeahead)this.titleNodes=this.emphasizeTextMatchingQuery(this.item.title,this.item.typeahead);else if(this.item instanceof m.B){let c=document.createElement("span");c.innerHTML=this.item.title,this.titleNodes=[c],this.item.persistentHint&&(this.persistentHint.innerHTML=this.item.persistentHint,this.persistentHint.hidden=!1)}else if(this.item instanceof p.K&&b){let d=[];d.push(document.createTextNode("Search"));let e=document.createElement("strong");e.textContent=` '${b}' `,d.push(e),d.push(document.createTextNode(this.item.titleScope)),this.titleNodes=d}else b&&(this.titleNodes=this.emphasizeTextMatchingQuery(this.item.title,b));return this}connectedCallback(){this.subtitle&&this.subtitleElement.removeAttribute("hidden"),this.titleNodes.length>0&&(this.titleElement.textContent="",this.titleElement.append(...this.titleNodes))}onClick(a){this.activate(this.commandPalette,a)}get commandPalette(){return this.closest("command-palette")}attributeChangedCallback(a,b,c){this.rendered&&("data-selected"===a?this.setSelectionAppearance():"data-item-title"===a?this.titleElement.textContent=c:"data-subtitle"===a&&(this.subtitleElement.textContent=c))}setSelectionAppearance(){this.selected?(this.containerElement.classList.add("color-bg-subtle"),this.hintText.hidden=!1):(this.containerElement.classList.remove("color-bg-subtle"),this.hintText.hidden=!0)}renderLinkContainer(a){return j.dy`
      <a
        data-target="${this.containerDataTarget}"
        data-action="click:command-palette-item#onClick"
        href="${this.href}"
        class="${this.containerClasses}"
        style="${this.containerStyle}"
      >
        ${a}
      </a>
    `}renderSpanContainer(a){return j.dy`
      <span
        data-target="${this.containerDataTarget}"
        class="${this.containerClasses}"
        style="${this.containerStyle}"
        data-action="click:command-palette-item#onClick"
      >
        ${a}
      </span>
    `}renderElementContent(){return j.dy`
      <div
        data-target="command-palette-item.iconElement"
        class="mr-2 color-fg-muted d-flex flex-items-center"
        style="height: 24px; min-width: 16px;"
      ></div>

      <div class="flex-1 d-flex flex-column" style="line-height: 24px;">
        <span data-target="command-palette-item.titleElement" class="color-fg-default f5">${this.itemTitle}</span>
        <p data-target="command-palette-item.subtitleElement" class="color-fg-muted f6 mb-0" hidden>${this.subtitle}</p>
      </div>

      <div class="color-fg-muted f5" style="line-height: 20px;">
        <span class="hide-sm" data-target="command-palette-item.hintText" style="line-height: 24px;" hidden
          >${this.getHint()}</span
        >
        <span
          class="hide-sm"
          data-target="command-palette-item.persistentHint"
          style="line-height: 24px;"
          hidden
        ></span>
      </div>
    `}renderBaseElement(){let a=this.renderElementContent();(0,j.sY)(this.href?this.renderLinkContainer(a):this.renderSpanContainer(a),this),this.rendered=!0}activateLinkBehavior(a,b,c){let e=this.containerElement;(0,t.c)("ACCESSIBLE_COMMAND_PALETTE")&&this.item instanceof q.g&&this.item.scope&&(function(a,b,c){if(!b.has(a))throw TypeError("attempted to get private field on non-instance");return c})(this,d,w).call(this,this.item.scope,a.commandPaletteInput.scope)?a.setScope(this.item.scope):c&&e instanceof HTMLAnchorElement?(this.newTabOpened=!0,this.openLinkInNewTab(e)):(this.newTabOpened=!1,this.openLink(e))}openLinkInNewTab(a){let b=a.getAttribute("target");a.setAttribute("target","_blank"),a.click(),b?a.setAttribute("target",b):a.removeAttribute("target")}openLink(a){a.click()}copyToClipboardAndAnnounce(a,b){(0,r.z)(a);let c=this.hintText,d=c.textContent;c.classList.add("color-fg-success"),c.textContent=b??"Copied!",setTimeout(()=>{c.classList.remove("color-fg-success"),c.textContent=d},2e3)}getHint(){return this.item instanceof l.i||this.item instanceof m.B?j.dy``:this.hint?j.dy`<span class="hide-sm">${this.hint}</span>`:this.item instanceof q.g&&this.item.scope?j.dy`<div class="hide-sm">
        <kbd class="hx_kbd">Enter</kbd>
        to jump to
        <kbd class="hx_kbd ml-1">Tab</kbd>
        to search
      </div>`:j.dy`<span class="hide-sm">Jump to</span>`}emphasizeTextMatchingQuery(a,b){if(!(0,k.CD)(b,a)){let c=document.createTextNode(a);return[c]}let d=[],e=0;for(let f of(0,k.m7)(b,a)){let g=a.slice(e,f);if(""!==g){let h=document.createTextNode(a.slice(e,f));d.push(h)}e=f+1;let i=document.createElement("strong");i.textContent=a[f],d.push(i)}let j=document.createTextNode(a.slice(e));return d.push(j),d}constructor(...a){var b,c;super(...a),b=this,function(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}(b,c=d),c.add(b),this.titleNodes=[],this.rendered=!1,this.newTabOpened=!1,this.containerDataTarget="command-palette-item.containerElement",this.containerClasses="mx-2 px-2 rounded-2 d-flex flex-items-start no-underline border-0",this.containerStyle="padding-top: 10px; padding-bottom: 10px; cursor: pointer;",this.itemId="",this.itemTitle="",this.subtitle="",this.selected=!1,this.score=0}}).observedAttributes=["data-selected","data-item-title","data-subtitle"],e);function w(a,b){return a.tokens.length!==b.tokens.length||a.tokens.some((a,c)=>{let d=b.tokens[c];return a.id!==d.id||a.type!==d.type||a.text!==d.text})}u([i.Lj],v.prototype,"itemId",void 0),u([i.Lj],v.prototype,"itemTitle",void 0),u([i.Lj],v.prototype,"subtitle",void 0),u([i.Lj],v.prototype,"selected",void 0),u([i.Lj],v.prototype,"score",void 0),u([i.fA],v.prototype,"titleElement",void 0),u([i.fA],v.prototype,"iconElement",void 0),u([i.fA],v.prototype,"subtitleElement",void 0),u([i.fA],v.prototype,"hintText",void 0),u([i.fA],v.prototype,"persistentHint",void 0),u([i.fA],v.prototype,"containerElement",void 0),v=u([i.Ih],v);var x=c(25543),y=c(48084),z=c(50034),A=c(3447),B=c(89803);function C(a,b,c){if(!b.has(a))throw TypeError("attempted to "+c+" private field on non-instance");return b.get(a)}function D(a,b){var c,d,e=C(a,b,"get");return c=a,(d=e).get?d.get.call(c):d.value}function E(a,b,c){!function(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}(a,b),b.set(a,c)}function F(a,b,c){var d=C(a,b,"set");return!function(a,b,c){if(b.set)b.set.call(a,c);else{if(!b.writable)throw TypeError("attempted to set read only private field");b.value=c}}(a,d,c),c}var G=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};let H=(f=new WeakMap,g=new WeakMap,h=class CommandPalettePageElement extends HTMLElement{get providers(){return this.page?.providers||[]}get query(){return D(this,f)}set query(a){this.items[a.path]||(this.items[a.path]=this.currentItems.filter(b=>b.calculateScore(a.text)>0)),F(this,f,a)}get scope(){return{text:this.pageTitle,type:this.scopeType,id:this.scopeId,tokens:[]}}get selectedItem(){return this.findSelectedElement()}set selectedItem(a){let b=this.findSelectedElement();b&&(b.selected=!1),a&&(a.selected=!0,this.selectedItemChanged(a.item))}get page(){return D(this,g)}set page(a){a&&(F(this,g,a),this.pageTitle=a.title,this.scopeId=a.scopeId,this.scopeType=a.scopeType)}get groups(){return Array.from(this.querySelectorAll("command-palette-item-group"))}get visibleGroups(){return this.groups.filter(a=>!a.hidden)}get currentItems(){let a=this.items[this.query.path];return a?this.query.isBlank()?a.sort((a,b)=>b.priority-a.priority):a.sort((a,b)=>{let c=a.calculateScore(this.query.text),d=b.calculateScore(this.query.text);return d-c||b.priority-a.priority}):[]}get firstItem(){let a=this.visibleGroups;if(a.length>0)return a[0].querySelector("command-palette-item")}get shouldSetDefaultSelection(){return this.tryDefaultSelection&&this.query.isPresent()}get isSelectedItemInvalid(){return!this.currentItems.some(a=>a.id===this.selectedItem?.itemId)}updateSelectedItem(){this.isSelectedItemInvalid&&this.clearSelection(),this.setDefaultSelection()&&(this.selectedItem=this.firstItem)}setDefaultSelection(){let a=this.query.hasScope()||this.query.isPresent();return this.tryDefaultSelection&&a}clearSelection(){this.selectedItem=void 0}findSelectedElement(){return this.querySelector("command-palette-item[data-selected]")}findGroup(a){return this.groups.find(b=>b.groupId===a)}navigate(a){this.tryDefaultSelection=!1;let b=a>0,c={behavior:"smooth",block:"nearest"};if(this.selectedItem){let d;if(d=b?this.selectedItem?.nextElementSibling:this.selectedItem?.previousElementSibling)this.selectedItem=d,this.selectedItem.scrollIntoView(c);else if(this.selectedItem){let e=this.visibleGroups[this.calculateIndex(a)];e.scrollIntoView(c),b?this.selectedItem=e.firstItem:this.selectedItem=e.lastItem}}else this.selectedItem=this.firstItem}calculateIndex(a){let b=this.visibleGroups.findIndex(a=>a.groupId===this.selectedItem?.item.group);this.findGroup(x.O.topGroupId).firstItem===this.selectedItem&&(b=0);let c=b+a,d=this.visibleGroups.length;return(c%d+d)%d}async fetchWithDebounce(a,b,c){return a instanceof B.j?a.element.fetchWithDebounce(b,c):a.fetch(b,c)}async fetch(a=this.providers,b={}){if(this.hidden)return;let c={isEmpty:!1},d={...c,...b},e=this.query;await this.fetchWithSpinner(a.map(async a=>{if(!a||!a.enabledFor(e))return;a.prefetch&&await a.prefetch(e);let b=await this.fetchWithDebounce(a,e,d.isEmpty);b&&(b.error&&this.fetchError(),b.octicons&&b.octicons.length>0&&this.cacheIcons(b.octicons,!0),b.results.length>0&&this.addItems(e,b.results),this.renderCurrentItems())})),this.itemsUpdated()}async fetchWithSpinner(a){this.requestsInProgress.push(a),this.loadingStateChanged(!0),await Promise.all(a),this.requestsInProgress.splice(this.requestsInProgress.indexOf(a),1),this.loadingStateChanged(this.requestsInProgress.length>0)}addItems(a,b){a.path in this.items||(this.items[a.path]=[]),this.items[a.path].push(...b)}cacheIcons(a,b=!1){for(let c of a)this.octicons[c.id]=c.svg;b&&this.dispatchEvent(new CustomEvent("command-palette-page-octicons-cached",{bubbles:!0,detail:{octicons:a}}))}buildGroups(a){let b=[x.O.topGroupId,x.O.defaultGroupId,...new Set(a.map(a=>a.group))],c=b.map(a=>`command-palette-item-group[data-group-id="${a}"]`).join(","),d=document.querySelectorAll(c);for(let e of d)this.querySelector(`command-palette-item-group[data-group-id="${e.groupId}"]`)||this.append(e.cloneNode(!0))}setGroupBorders(){if(this.visibleGroups.length>0)for(let a of(this.visibleGroups[0].classList.remove("border-top"),this.visibleGroups)){let b=this.visibleGroups.indexOf(a);0===b?(a.classList.remove("border-top"),a.header&&(a.classList.remove("py-2"),a.classList.add("mb-2"),this.hasVisibleTip?a.classList.remove("mt-3"):a.classList.add("mt-3"))):(a.classList.add("border-top"),a.header&&(a.classList.remove("mb-2","mt-3"),a.classList.add("py-2")))}}createItemElementAndRender(a,b,c){let d=new v;return d.setItemAttributes(a),d.render(b,c),d}renderCurrentItems(){this.reset();let a=this.currentItems,b=[];if(a&&a.length>0){for(let c of(this.buildGroups(a),a)){if(b.indexOf(c.id)>=0)continue;let d=c.calculateScore(this.query.text)+c.priority,e=c.group||x.O.defaultGroupId;0===a.indexOf(c)&&d>CommandPalettePageElement.TopResultThreshold&&(e="top");let f=this.createItemElementAndRender(c,!1,this.query.text),g=this.querySelector(`command-palette-item-group[data-group-id="${e}"]`);if(!g.atLimitForScopeType(this.scopeType)){if(g.push(f),b.push(c.id),c.icon){if("octicon"===c.icon.type){let h=this.octicons[c.icon.id],i=this.octicons["dash-color-fg-muted"];f.renderOcticon(h||i)}else"avatar"===c.icon.type&&f.renderAvatar(c.icon.url,c.icon.alt)}else f.iconElement.hidden=!0;f.addEventListener("mousemove",a=>{let b=0!==a.movementX||0!==a.movementY;b&&this.selectedItem?.itemId!==f.itemId&&(this.tryDefaultSelection=!1,this.selectedItem=f)})}}this.shouldSetDefaultSelection&&(this.selectedItem=this.firstItem),this.recomputeStyles(),this.updateSelectedItem()}}recomputeStyles(){this.setGroupBorders(),this.setMaxHeight()}get maximumHeight(){let a=50,b=window.innerHeight*(a/100);return Math.min(b,475)}get innerContentHeight(){let a=0;for(let b of this.children){let c=b,d=getComputedStyle(c),e=parseInt(d.marginTop.replace("px",""),10),f=parseInt(d.marginBottom.replace("px",""),10),g=c.offsetHeight+e+f;c.offsetHeight>0&&(a+=g)}return a}setMaxHeight(){let a=.9*this.maximumHeight,b=Math.round(Math.min(this.maximumHeight,this.innerContentHeight)),c=Math.abs(this.currentHeight-b);c>a?this.classList.add("no-transition"):this.classList.remove("no-transition"),this.setAttribute("style",`max-height:${b}px; min-height:${b}px;`),this.currentHeight=b}selectedItemChanged(a){let b=new CustomEvent("selectedItemChanged",{bubbles:!0,cancelable:!0,detail:{item:a,isDefaultSelection:this.tryDefaultSelection}});return this.dispatchEvent(b)}loadingStateChanged(a){let b=new CustomEvent("loadingStateChanged",{bubbles:!0,cancelable:!0,detail:{loading:a}});return this.dispatchEvent(b)}fetchError(){let a=new CustomEvent("pageFetchError",{bubbles:!0,cancelable:!0});return this.dispatchEvent(a)}itemsUpdated(){let a=this.currentItems,b=a.filter(a=>a.group===x.O.footerGroupId||x.O.helpGroupIds.includes(a.group));if(a.length-b.length==0&&this.requestsInProgress.length>0)return;let c=new CustomEvent("itemsUpdated",{bubbles:!0,detail:{items:a,queryPath:this.query.immutableCopy().path}});return this.dispatchEvent(c)}reactivate(a){this.query=a,this.hidden=!1,this.tryDefaultSelection=!0,this.recomputeStyles(),this.fetch()}reset(){this.tryDefaultSelection=!0,this.innerHTML=""}connectedCallback(){this.classList.add("rounded-bottom-2","page-stack-transition-height"),this.getAttribute("data-targets")||this.setAttribute("data-targets","command-palette-page-stack.pages"),this.setAttribute("style","max-height:400px;"),this.page||(this.page=new y.j({title:this.pageTitle,scopeId:this.scopeId,scopeType:this.scopeType}))}clearItems(){this.items={},this.reset()}constructor(a={}){super(),this.currentHeight=0,this.octicons={},E(this,f,{writable:!0,value:void 0}),this.requestsInProgress=[],E(this,g,{writable:!0,value:void 0}),this.tryDefaultSelection=!0,this.items={},this.isRoot=!1,this.pageTitle="",this.scopeId="",this.scopeType="",this.hasVisibleTip=!1,this.hidden=a.hidden?? !0,this.page=a.page,F(this,f,new z.A("","",{scope:this.scope,subjectId:a.defaultScopeId,subjectType:a.defaultScopeType}))}},h.TopResultThreshold=6.5,h);G([i.Lj],H.prototype,"isRoot",void 0),G([i.Lj],H.prototype,"pageTitle",void 0),G([i.Lj],H.prototype,"scopeId",void 0),G([i.Lj],H.prototype,"scopeType",void 0),G([i.Lj],H.prototype,"hasVisibleTip",void 0),G([(0,A.D)(10)],H.prototype,"renderCurrentItems",null),H=G([i.Ih],H)}}])
//# sourceMappingURL=app_components_command_palette_command-palette-page-element_ts-91d94662dead.js.map